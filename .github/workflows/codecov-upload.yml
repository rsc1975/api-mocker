name: Upload coverage data to codecov.io
on:
  push:
    branches:
      - main
jobs:
  test-coverage:
    uses: ./.github/workflows/qa-coverage.yml

  upload-codecov:
    runs-on: ubuntu-latest
    needs: test-coverage
    steps:
      - run: echo "üéâ The job was automatically triggered by a ${{ github.event_name }} event."
      - run: ls -ltr
      - name: Download the coverage report
        uses: actions/download-artifact@v3
        with:
          name: code-coverage-report
      - name: Upload coverage reports to Codecov
        run: |
          curl -Os https://uploader.codecov.io/latest/linux/codecov
          chmod +x codecov
          ./codecov -t ${CODECOV_TOKEN} 
      - run: echo "üçè This job's status is ${{ job.status }}."
