#!/usr/bin/env node
'use strict';

const path = require("path");
const { readdirSync, rmSync, writeFileSync } = require('fs');

const distDir = path.join(__dirname, "..", "dist");
readdirSync(distDir).forEach(f => rmSync(`${distDir}/${f}`, { recursive: true }));

const pkg = require(path.join(__dirname, "..", "package.json"));

pkg.scripts = {
    "prepack": "copyfiles ../src/**/*.* ../bin/api* ../examples/**/* ./dist"
};
delete pkg.files;
delete pkg.devDependencies;
delete pkg.dependencies;
pkg.main = "./api-mockr.min.js";


writeFileSync("dist/package.json", JSON.stringify(pkg, null, 2));